---
import type { ImageMetadata } from "astro";
import { getImage } from "astro:assets";

export interface Props {
  src: ImageMetadata;
  size?: number | string;
  color?: string;
}

const { src, size = "1em", color = "currentColor" } = Astro.props;

const iconSize = typeof size === "number" ? `${size}px` : size;
const iconSrc = await getImage({ src, format: "avif" }).then(
  (img) => `url(${img.src})`,
);
---

<div class="icon"></div>

<style define:vars={{ iconSize, iconSrc, iconColor: color }}>
  .icon {
    display: inline-block;
    inline-size: var(--iconSize);
    block-size: var(--iconSize);
    background: var(--iconColor);
    mask: var(--iconSrc) no-repeat center / contain;
    transition: scale 0.6s 0.4s ease;
  }
</style>
